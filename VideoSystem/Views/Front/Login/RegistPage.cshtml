@{Layout = null;}

<!DOCTYPE html>
<html>
    <head>
        <link href="~/Content/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
        <link href="~/Content/app.css" rel="stylesheet" />
        <script src="~/Scripts/jquery-1.8.2.min.js"></script>
        <script src="~/Content/bootstrap/js/bootstrap.min.js"></script>
        <script src="~/Scripts/Utils.js"></script>
        <script src="~/Scripts/JQuery.md5.js"></script>
        <link type="text/css" rel="stylesheet" href="~/Content/pagecss/login.css" />
        <link type="text/css" rel="stylesheet" href="~/Content/pagecss/registe.css" />
        <title>用户注册</title>
    </head>

    <body>
        <div class="navbar navbar-default head_footer">
            <div class="container">
               <img src="~/Image/logo.png"/ width="380" height="60">
            </div>
        </div>

        <div style="text-align: center;">
            <p id="app_head" style="margin:0"><b>古驿平安串珠视频系统</b></p>
        </div>

        <div id="register_div" style="position:absolute;bottom:50%; width:100%; margin-bottom:-240px;padding:10px;">
            <div class="container">
                <div class="row register_row" style="padding:10px">
                    <div class="col-sm-12 col-md-6 col-lg-6 col-md-offset-3" id="div_login">
                        <form class="form-horizontal" role="form" method="post" action="@Url.Content("~/Login/Regist")" id="registForm">
                            <div class="form_table" id="form_id" style="padding:10px;">
                                <table style=" width:100%; border-spacing: 10px;  border-collapse: separate;">
                                    <caption style="text-align: center; padding: 0">
                                        <h3 style="margin: 2px; color:#333">用户注册</h3>
                                    </caption>
                                    <tr>
                                        <td colspan="2">
                                            <label class="control-label">账 号</label>
                                        </td>
                                        <td colspan="4">
                                            <input type="text" class="form-control" id="UserAccount"  name="UserAccount" required autofocus onblur="isAccountExist();">
                                        </td>
                                    </tr>

                                    <tr>
                                        <td colspan="2">
                                            <label class="control-label">密 码</label>
                                        </td>
                                        <td colspan="4">
                                            <input type="password" class="form-control" id="UserPassword"  name="UserPassword" required onblur="passLenth();">
                                        </td>
                                    </tr>

                                    <tr>
                                        <td colspan="2">
                                            <label class="control-label">确 认</label>
                                        </td>
                                        <td colspan="4">
                                            <input type="password" class="form-control" id="UserConfirmPassword"  name="UserConfirmPassword" required onblur="isPassSame();">
                                        </td>
                                    </tr>

                                    <tr>
                                        <td colspan="2">
                                            <label class="control-label">邮 箱</label>
                                        </td>
                                        <td colspan="4">
                                            <input type="text" class="form-control" id="email" name="UserEmail"  required onblur="checkEmail();">
                                        </td>
                                    </tr>

                                    <tr>
                                        <td colspan="2">
                                            <label class="control-label">手 机</label>
                                        </td>
                                        <td colspan="4">
                                            <input type="text" class="form-control regist_input" id="phone" name="UserPhone" required onblur="checkPhone();">
                                            <input type="hidden" name="UserBrowser1" value="no"/>
                                            <input type="hidden" name="UserBrowser2" value="no"/>
                                            <input type="hidden" name="UserBrowser3" value="no"/>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td colspan="2" style="width: 25%">
                                        <td colspan="2" style="width: 37.5%">
                                            <input type="text" class="form-control" id="code"  name="code" required>
                                        </td>
                                        <td colspan="2" style="width: 37.5%">
                                            <a onclick="refreshCode();">
                                                <img src="@Url.Content("~/VerifyCode")" style="width:100%; height:100%" id="codeImg"/>
                                            </a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="2" style="width: 25%">
                                        <td colspan="2" style="width: 37.5%">
                                            <button type="button" class="btn btn-success" id="registe_btn" onclick="regist();">注册</button>
                                        </td>
                                        <td colspan="2" style="width: 37.5%">
                                            <button type="reset" class="btn btn-success"  id="reset_btn">重置</button>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
      </body>
</html>

@*<script src="~/Scripts/customjs/registe.js"></script>*@

<script>
    var pass = jQuery("#UserPassword");
    var confirmPass = jQuery("#UserConfirmPassword");
    var accountElement = jQuery("#UserAccount");
    var verifycode = jQuery("#verifycode");

    /*
       检查账号是否存在
    */
    function isAccountExist() {
        if (accountElement.val().length <= 0) {
            alert("账号不能为空!");
            accountElement.focus();
            return;
        }

        jQuery.post(
            "@Url.Content("~/Login/IsRegistAccountExist")",
            { "account": accountElement.val() },
            function (data, statusText, xhr) {
                if (data == "erro") {
                    alert("此账号已存在，请重新输入!");
                    accountElement.val("");
                    accountElement.focus();
                    return;
                }
            },
            "text"
        );
    }

    /*
       检查密码长度
    */
    function passLenth() {
        if (pass.val().length <= 0) {
            alert("密码不能为空！");
            pass.focus();
            return;
        }
        if (pass.val().length < 8) {
            alert("密码长度不能小于8位！");
            pass.focus();
            return;
        }
    }

    /*
        检查密码是否一致
    */
    function isPassSame() {

        if (pass.val().length > 0) {
            if (confirmPass.val() != pass.val()) {
                alert("两次密码不一致，请重新输入!");
                confirmPass.val("");
                confirmPass.focus();
                return;
            }
        }
    }

   //加密密码
    function regist() {
        var password = jQuery("#UserPassword").val();
        var UserConfirmPassword = jQuery("#UserConfirmPassword").val();

        var passMD5 = $.md5(password).toLocaleUpperCase();
        var passConfirmMD5 = $.md5(UserConfirmPassword).toLocaleUpperCase();

        jQuery("#UserPassword").val(passMD5);
        jQuery("#UserConfirmPassword").val(passConfirmMD5);

        jQuery("#registForm").submit();
    }
</script>